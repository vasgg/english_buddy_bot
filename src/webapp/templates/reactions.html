{% extends "base.html" %}
{% block title %}Реакции{% endblock %}
{% block content %}
<div class="container mt-4">
    <h3 class="text-left">Редактирование реакций</h3>
    <form id="editReactionsForm" action="/reactions" method="post">
        <div class="reactions-form-title d-flex justify-content-between align-items-center">
            <h4>RIGHT</h4>
            <button type="button" class="btn btn-success btn-square" onclick="addReaction('right')">+</button>
        </div>
        <div id="right-reactions">
            {% for reaction in right %}
            <div class=" reactions-input-wrapper mb-2">
                <input type="text" class="form-control " name="right_{{ reaction.id }}" value="{{ reaction.text }}">
                <div class="input-group-append">
                    <button class="btn btn-danger btn-square" type="button" onclick="confirmDeletion({{ reaction.id }})">-</button>
                </div>
            </div>
            {% endfor %}
        </div>

        <div class="reactions-form-title d-flex justify-content-between align-items-center">
            <h4>WRONG</h4>
            <button type="button" class="btn btn-success btn-square" onclick="addReaction('wrong')">+</button>
        </div>
        <div id="wrong-reactions">
            {% for reaction in wrong %}
            <div class="reactions-input-wrapper mb-2">
                <input type="text" class="form-control" name="wrong_{{ reaction.id }}" value="{{ reaction.text }}">
                <div class="input-group-append">
                    <button class="btn btn-danger btn-square" type="button" onclick="confirmDeletion({{ reaction.id }})">-</button>
                </div>
            </div>
            {% endfor %}
        </div>
    </form>
</div>


{% endblock %}
{% block sidebar_content %}
<div class="sidebar__button-wrapper">
    <button id="save" type="submit" class="btn btn-success">Сохранить</button>

</div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
      document.getElementById('save').addEventListener('click', async function(e) {
        e.preventDefault(); // Prevent standard form submission
        let formData = new FormData(document.getElementById('editReactionsForm'));
        console.log("Form data being sent:", formData);

        try {
          let response = await fetch('/reactions', {
            method: 'POST',
            body: formData
          });
          if (!response.ok) throw new Error(`HTTP error! Status: ${response.status}`);
          let result = await response.json();
          console.log("Server response:", result);
          alert(result.message); // Display the message
        } catch (error) {
          console.error("Error during form submission:", error);
          alert("Error saving: " + error); // Display the error
        }
      });
    });
</script>
{% endblock %}
